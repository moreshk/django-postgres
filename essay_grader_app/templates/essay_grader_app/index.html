{% extends "base.html" %}
{% block content %}
<div class="container">
    <h2>Grade Your Essay</h2>

    <form method="post">
        {% csrf_token %}


        <!-- Dropdown for exam type -->
        <div class="form-group">
            <label for="examType">Choose an exam type:</label>

            <select name="examType" id="examType" class="form-control" onchange="showDropdowns(this.value)">
                <option value="IELTS" {% if exam_type == "IELTS" %}selected{% endif %}>IELTS</option>
                <option value="NAPLAN" {% if exam_type == "NAPLAN" %}selected{% endif %}>NAPLAN</option>
            </select>
        </div>

        <!-- Dropdowns for NAPLAN specifics -->
        <div id="naplanDropdowns" style="display: none;">
            <div class="form-group">
                <label for="essayType">Essay Type:</label>

                <select name="essayType" id="essayType" class="form-control">
                    <option value="Narrative" {% if essay_type == "Narrative" %}selected{% endif %}>Narrative</option>
                    <option value="Persuasive" {% if essay_type == "Persuasive" %}selected{% endif %}>Persuasive</option>
                </select>
            </div>

            <div class="form-group">
                <label for="grade">Grade:</label>

                <select name="grade" id="grade" class="form-control">
                    <option value="Grade 3" {% if grade == "Grade 3" %}selected{% endif %}>Grade 3</option>
                    <option value="Grade 5" {% if grade == "Grade 5" %}selected{% endif %}>Grade 5</option>
                    <option value="Grade 7" {% if grade == "Grade 7" %}selected{% endif %}>Grade 7</option>
                    <option value="Grade 9" {% if grade == "Grade 9" %}selected{% endif %}>Grade 9</option>
                </select>
            </div>
        </div>

        <!-- Keep the Generate Test button at the top -->
        <button type="submit" name="generate_test" class="btn btn-secondary mb-3">Generate Test</button>

        <!-- Display the Hello World message below the button -->
        {% if message %}
        <div class="alert alert-info mt-3 mb-3">
            {{ message|safe }}
            <!-- <strong>Title:</strong> {{ title }}<br>
            <strong>Description:</strong> {{ description|linebreaks }} -->

        </div>
        {% endif %}


        <div class="form-group">
            <label for="text_input">Your Text:</label>
            <textarea id="text_input" name="text_input" class="form-control"
                rows="10">{{ request.POST.text_input }}</textarea>
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
    </form>

    <!-- Feedback section -->
    {% if feedback %}
    <div class="form-group mt-4">
        <label for="feedback_area">Feedback:</label>
        <textarea id="feedback_area" name="feedback_area" class="form-control" rows="10"
            readonly>{{ feedback }}</textarea>
    </div>
    {% endif %}

    <div class="mt-4">
        <a href="{% url 'logout' %}">Logout</a>
    </div>
</div>

<script>
    function showDropdowns(value) {
        if (value === "NAPLAN") {
            document.getElementById("naplanDropdowns").style.display = "block";
        } else {
            document.getElementById("naplanDropdowns").style.display = "none";
        }
    }
    document.addEventListener("DOMContentLoaded", function () {
        // Get the value of the examType dropdown
        var examTypeValue = document.getElementById("examType").value;
        // Call the showDropdowns function with the current value
        showDropdowns(examTypeValue);
    });


</script>

{% endblock %}